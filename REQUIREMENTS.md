# 「今日の天気」アプリ 要件定義書

## 1. アプリ概要

### 1.1 アプリ名

今日の天気

### 1.2 コンセプト

「シンプルで使いやすい」をコンセプトにした天気予報アプリ。必要最小限の天気情報を大きく見やすく表示し、複雑な機能を排除。

### 1.3 ターゲットユーザー

20 代〜50 代の、シンプルな天気情報を求めるユーザー

### 1.4 主要機能

- 現在地の天気を自動取得
- 今日と明日の天気予報表示
- 時間帯別の降水確率表示
- 天気に応じた背景グラデーション

## 2. 機能要件

### 2.1 天気情報表示機能

#### 表示内容

- **今日の天気**

  - 天気アイコン（☀️🌤️☁️🌧️⛈️）
  - 天気テキスト（晴れ、曇り、雨など）
  - 最高気温 / 最低気温
  - 時間帯別降水確率（朝・昼・夕・夜）

- **明日の天気**

  - 天気アイコン
  - 最高気温 / 最低気温

- **その他**
  - 最終更新時刻
  - 雷雨時のアラート表示

#### 時間帯の定義

- 朝：0-6 時
- 昼：6-12 時
- 夕：12-18 時
- 夜：18-24 時

### 2.2 位置情報機能

- アプリ起動時に現在地を自動取得
- GPS による位置情報取得
- 位置情報の許可が必要

### 2.3 データ更新機能

- 1 時間ごとの自動更新
- アプリ起動時の自動更新
- 最終更新時刻の表示

### 2.4 背景グラデーション機能

- 1 日の天気変化を背景色で表現
- 朝・昼・夜の天気に基づいてグラデーション生成

#### 色の定義

- 晴れ：青系（上部）→ オレンジ系（下部）
- 曇り：グレー系のグラデーション
- 雨：濃いグレー → 薄いグレー

#### 判定ロジック

- 朝（6 時）、昼（12 時）、夜（18 時）の天気を取得
- 優先順位：雨 > 曇り > 晴れ
- 複数の天気がある場合は多色グラデーション

## 3. 非機能要件

### 3.1 UI/UX 要件

- **デザイン**

  - 1 画面完結のシンプル構成
  - 中央に大きく情報表示
  - 見やすさ重視の大きめフォント
  - 天気に応じた動的背景

- **レイアウト構成**

  ```
  今日の天気
  ━━━━━━━━━
  [天気アイコン]
  晴れ
  25℃ / 18℃

  降水確率
  朝 昼 夕 夜
  0% 10% 30% 60%

  明日の天気
  [アイコン] 22℃/16℃
  ━━━━━━━━━
  最終更新: 10:30
  ```

### 3.2 パフォーマンス要件

- アプリ起動：3 秒以内
- 天気データ取得：5 秒以内
- オフライン時も最後のデータを表示

## 4. 技術仕様

### 4.1 技術スタック

- **フレームワーク**: Expo (React Native) 最新版
- **対応プラットフォーム**: iOS, Android
- **言語**: JavaScript/TypeScript
- **状態管理**: React Hooks
- **ストレージ**: AsyncStorage
- **開発ツール**: Claude Code

### 4.2 外部 API

- **天気情報**: OpenWeatherMap API（無料プラン）
  - 制限：1 日 1,000 回の API コール
  - 3 時間ごとの予報データを使用

### 4.3 データ構造

```javascript
{
  "lastUpdate": "2025-01-20T10:30:00",
  "location": {
    "lat": 35.6762,
    "lon": 139.6503
  },
  "today": {
    "weather": "晴れ",
    "tempMax": 25,
    "tempMin": 18,
    "rainChance": [0, 10, 30, 60], // 朝昼夕夜
    "hourlyWeather": ["sunny", "sunny", "cloudy", "rainy"]
  },
  "tomorrow": {
    "weather": "曇り",
    "tempMax": 22,
    "tempMin": 16
  }
}
```

### 4.4 キャッシュ戦略

- 1 時間以内のデータは再利用
- AsyncStorage に最後の取得データを保存
- オフライン時はキャッシュデータを表示

## 5. エラー処理

### 5.1 位置情報エラー

- 位置情報が取得できない場合：「位置情報を許可してください」と表示
- 設定画面への誘導

### 5.2 API 関連エラー

- API 制限到達時：最後に取得したデータを表示
- ネットワークエラー時：キャッシュデータを使用
- データ取得失敗時：エラーメッセージを表示

### 5.3 オフライン対応

- 最後に取得したデータを表示
- 「オフライン」インジケーター表示
- 自動更新の一時停止

## 6. 将来の拡張予定

### 6.1 計画中の機能

- 地域を手動で選択する機能
- 手動更新（プルダウンリフレッシュ）
- 花粉情報の表示
- ウィジェット対応
- 複数地域の登録

### 6.2 拡張時の考慮事項

- シンプルさを維持
- 1 画面完結の原則を守る
- 必要最小限の機能追加

## 7. 制約事項

- データベース不使用（ローカルストレージのみ）
- 週間天気予報なし
- 詳細な時間ごと予報なし
- プッシュ通知なし
- 天気図や衛星画像なし
- 広告なし
